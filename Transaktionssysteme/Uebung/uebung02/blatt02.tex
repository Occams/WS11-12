%%%
% Excercise Template
%%%

%\listfiles 
\documentclass[12pt]{scrartcl} 
\usepackage[english,ngerman]{babel}
    
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{graphicx,enumitem,wasysym,multicol,libertine,xcolor,microtype,lipsum,fixltx2e,
	fancyhdr,vmargin,calc,lastpage,hyperref,listings,lastpage,lipsum,preview,tikz}
\usetikzlibrary{snakes,arrows,shapes}


% ------------------------------------------
% -------- xcolor - (Tango)
% ------------------------------------------

\definecolor{LightButter}{rgb}{0.98,0.91,0.31}
\definecolor{LightOrange}{rgb}{0.98,0.68,0.24}
\definecolor{LightChocolate}{rgb}{0.91,0.72,0.43}
\definecolor{LightChameleon}{rgb}{0.54,0.88,0.20}
\definecolor{LightSkyBlue}{rgb}{0.45,0.62,0.81}
\definecolor{LightPlum}{rgb}{0.68,0.50,0.66}
\definecolor{LightScarletRed}{rgb}{0.93,0.16,0.16}
\definecolor{Butter}{rgb}{0.93,0.86,0.25}
\definecolor{Orange}{rgb}{0.96,0.47,0.00}
\definecolor{Chocolate}{rgb}{0.75,0.49,0.07}
\definecolor{Chameleon}{rgb}{0.45,0.82,0.09}
\definecolor{SkyBlue}{rgb}{0.20,0.39,0.64}
\definecolor{Plum}{rgb}{0.46,0.31,0.48}
\definecolor{ScarletRed}{rgb}{0.80,0.00,0.00}
\definecolor{DarkButter}{rgb}{0.77,0.62,0.00}
\definecolor{DarkOrange}{rgb}{0.80,0.36,0.00}
\definecolor{DarkChocolate}{rgb}{0.56,0.35,0.01}
\definecolor{DarkChameleon}{rgb}{0.30,0.60,0.02}
\definecolor{DarkSkyBlue}{rgb}{0.12,0.29,0.53}
\definecolor{DarkPlum}{rgb}{0.36,0.21,0.40}
\definecolor{DarkScarletRed}{rgb}{0.64,0.00,0.00}
\definecolor{Aluminium1}{rgb}{0.93,0.93,0.92}
\definecolor{Aluminium2}{rgb}{0.82,0.84,0.81}
\definecolor{Aluminium3}{rgb}{0.73,0.74,0.71}
\definecolor{Aluminium4}{rgb}{0.53,0.54,0.52}
\definecolor{Aluminium5}{rgb}{0.33,0.34,0.32}
\definecolor{Aluminium6}{rgb}{0.18,0.20,0.21}
\definecolor{Brown}{cmyk}{0,0.81,1,0.60}
\definecolor{OliveGreen}{cmyk}{0.64,0,0.95,0.40}
\definecolor{CadetBlue}{cmyk}{0.62,0.57,0.23,0}

% ------------------------------------------
% -------- vmargin
% ------------------------------------------

%\setmarginsrb{hleftmargini}{htopmargini}{hrightmargini}{hbottommargini}%{hheadheighti}{hheadsepi}{hfootheighti}{hfootskipi}
\setpapersize{A4}
\setmarginsrb{3cm}{1cm}{3cm}{1cm}{8mm}{4mm}{3mm}{15mm}

% ------------------------------------------
% -------- listings
% ------------------------------------------
 
\lstdefinestyle{inline} {
		basicstyle=\normalsize
		}

\lstset{
		breakautoindent=true,
		breakindent=2em,
		breaklines=true,
		tabsize=4,
		frame=blrt,
		frameround=tttt,
		captionpos=b,
		basicstyle=\scriptsize\ttfamily,
		keywordstyle={\color{SkyBlue}},
		%commentstyle={\color{OliveGreen}},
		stringstyle={\color{OliveGreen}},
		showspaces=false,
		%numbers=right,
		%numberstyle=\scriptsize,
		%stepnumber=1, 
		%numbersep=5pt,
		%showtabs=false
		prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
		aboveskip={1.5\baselineskip},
		columns=fixed,
		upquote=true,
		extendedchars=true
		}


% ------------------------------------------
% -------- hyperref
% ------------------------------------------

\hypersetup{
	%breaklinks=true,
	pdfborder={0 0 0},
	bookmarks=true,         % show bookmarks bar?
	unicode=false,          % non-Latin characters in Acrobat’s bookmarks
	pdftoolbar=true,        % show Acrobat’s toolbar?
	pdfmenubar=true,        % show Acrobat’s menu?
	pdffitwindow=true,     % window fit to page when opened
	pdfstartview={FitH},    % fits the width of the page to the window
    pdfnewwindow=true,      % links in new window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=black,          % color of internal links
    citecolor=black,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=DarkSkyBlue           % color of external links
}

% ------------------------------------------
% -------- fancyhdr
% ------------------------------------------
\fancyheadoffset{\marginparsep+\marginparwidth}
\fancyhf{}
\fancyhead[L]{\bfseries{\nouppercase{\leftmark}}}
\fancyfoot[C]{\bfseries{\thepage\ of \pageref{LastPage}}}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0pt}

% ------------------------------------------
% -------- pdf specific
% ------------------------------------------

\pdfcompresslevel=3
%\pdfimageresolution=300
%\pdfinfo{
%/CreationDate (D:2010 09 01 00 00 00) % year(4) month(2) day(2) hour(2) minute(2) second(2)
%/ModDate      (D:2010 09 01 00 00 00) % modification date
%}

% ------------------------------------------
% -------- misc
% ------------------------------------------
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\clubpenalty = 10000
\widowpenalty = 10000
\displaywidowpenalty = 10000
\setlength\fboxsep{6pt}
\setlength\fboxrule{1pt}
\renewcommand*\oldstylenums[1]{{\fontfamily{fxlj}\selectfont #1}}

% ------------------------------------------
% -------- hyphenation rules
% ------------------------------------------
\hyphenation{}

\begin{document}
\pagestyle{fancy}

% -- Title

\title{\LARGE Transaktionssysteme -- Blatt 02\\ \large Team Amazonen -- Gruppe 1}
\author{\large Bastian Huber (51432) \and \large Sebastian Rainer (50882) \and \large Daniel Watzinger (51746)}
\date{\large\today}
\maketitle

\section{Herbrand-Semantik}
	\begin{enumerate}[label={\alph*)}]
		\item $S := r_{1}(y)r_{2}(y)w_{1}(y)r_{3}(z)w_{3}(z)r_{2}(x)w_{2}(x)w_{1}(x)c_{1}c_{2}c_{3}$\\[0.5cm]
			$H_{S} (w_{0}(x)) = f_{0}^{x}()$\\
			$H_{S} (w_{0}(y)) = f_{0}^{y}()$\\
			$H_{S} (w_{0}(z)) = f_{0}^{z}()$\\
			$H_{S} (r_{1}(y)) = H_{S} (w_{0}(y)) = f_{0}^{y}()$\\
			$H_{S} (r_{2}(y)) = H_{S} (w_{0}(y)) = f_{0}^{y}()$\\
			$H_{S} (w_{1}(y)) = f_{1}^{y}(H_{S} (r_{1}(y))) = f_{1}^{y}(f_{0}^{y}()) = f_{0}^{y}() + 1 $\\
			$H_{S} (r_{3}(z)) = H_{S} (w_{0}(z)) = f_{0}^{z}()$\\
			$H_{S} (w_{3}(z)) = f_{3}^{z}(H_{S} (r_{3}(z))) = f_{3}^{z}(f_{0}^{z}()) = f_{0}^{z}() + 1$\\
			$H_{S} (r_{2}(x)) = H_{S} (w_{0}(x)) = f_{0}^{x}()$\\
			$H_{S} (w_{2}(x)) = f_{2}^{x}(H_{S} (r_{2}(x)),H_{S} (r_{2}(y))) = f_{2}^{x}(f_{0}^{x}(),f_{0}^{y}()) = f_{0}^{x}() * f_{0}^{y}()$\\
			$H_{S} (w_{1}(x)) = f_{1}^{x}(H_{S} (r_{1}(y))) = f_{1}^{x}(f_{0}^{y}()) = f_{0}^{y}() + 1$\\[0.5cm]
			$H_S[S](x) = H_S(w_1 (x)) = f_0^y() + 1$\\
			$H_S[S](y) = H_S(w_1 (y)) = f_0^y() + 1$\\
			$H_S[S](z) = H_S(w_3 (z)) = f_0^z() + 1$\\
			
		\item $S^{'} := r_3(z)w_3(z)r_2(y)r_2(x)w_2(y)r_1(x)w_1(x)c_3c_2c_1$\\[0.5cm]
			$H_{S^{'}} (w_{0}(x)) = f_{0}^{x}()$\\
			$H_{S^{'}} (w_{0}(y)) = f_{0}^{y}()$\\
			$H_{S^{'}} (w_{0}(z)) = f_{0}^{z}()$\\
			$H_{S^{'}} (r_3(z)) = H_{S^{'}}  (w_0(z)) = f_0^z()$\\
			$H_{S^{'}} (w_3(z)) = f_3^z (H_{S^{'}} (r_3(z))) = f_3^z (f_0^z()) = f_0^z() + 1$\\
			$H_{S^{'}} (r_2(y)) = H_{S^{'}}  (w_0(y)) = f_0^y()$\\
			$H_{S^{'}} (r_2(x)) = H_{S^{'}}  (w_0(x)) = f_0^x()$\\
			$H_{S^{'}} (w_2(y)) = f_2^y (H_{S^{'}} (r_2(x)),H_{S^{'}} (r_2(y))) = f_2^y (f_0^x(),f_0^y() ) = f_0^x() * f_0^y()$\\
			$H_{S^{'}} (r_1(x)) = H_{S^{'}}  (w_0(x)) = f_0^x()$\\
			$H_{S^{'}} (w_1(x)) = f_1^z (H_{S^{'}} (r_1(x))) = f_1^z (f_0^x()) = f_0^x() + 1$\\[0.5cm]
			$H_S[S](x) = H_S(w_1 (x)) = f_0^x() + 1$\\
			$H_S[S](y) = H_S(w_2 (y)) = f_0^y() *  f_0^x()$\\
			$H_S[S](z) = H_S(w_2 (z)) = f_0^z() + 1$\\
	\end{enumerate}
	
\section{Final-State-Äquivalenz}
	\begin{enumerate}[label={\alph*)}]
		\item $S := w_0(x)w_0(y)w_0(z)c_0r_1(x)r_2(x)w_2(y)r_3(x)c_1r_2(z)w_3(z)c_3w_2(z)c_2$\\[0.5cm]
			$H_S (w_{0}(x)) = f_{0}^{x}()$\\
			$H_S (w_{0}(y)) = f_{0}^{y}()$\\
			$H_S (w_{0}(z)) = f_{0}^{z}()$\\
			$H_S (r_1(x)) = H_S  (w_0(x)) = f_0^x()$\\
			$H_S (r_2(x)) = H_S  (w_0(x)) = f_0^x()$\\
			$H_S (w_2(y)) = f_2^y (H_S (r_2(x))) = f_2^y (f_0^x())$\\
			$H_S (r_3(x)) = H_S  (w_0(x)) = f_0^x()$\\
			$H_S (r_2(z)) = H_S  (w_0(z)) = f_0^z()$\\
			$H_S (w_3(z)) = f_3^z (H_S (r_3(x))) = f_3^z (f_0^x())$\\
			$H_S (w_2(z)) = f_2^z (H_S (r_2(z)),H_S (r_2(x))) = f_2^z (f_0^z(),f_0^x())$
			
		\item
			$H[S](x) = H_S (w_{0}(x)) = f_{0}^{x}$\\
			$H[S](y) = H_S (w_2(y)) = f_2^y (f_0^x())$\\
			$H[S](z) = H_S (w_2(z)) = f_2^z (f_0^z(),f_0^x())$
		
		\item 
			$S^{'} := w_0(x)w_0(y)w_0(z)r_2(x)w_2(y)r_2(z)w_2(z)$
		
		\item Nein den es gilt $op(S) \neq op(S^{'})$ und  $H[S] = H[S{'}]$. Somit sind $S$ und $S^{'}$ nicht final state äquivalent.
	\end{enumerate}
	
\section{Final-State-Serialisierbarkeit und View-Serialisierbarkeit}
	Gegeben sei der Schedule $S := r_1(x)r_2(y)w_2(x)r_3(x)r_3(z)w_3(z)w_1(z)$
	\begin{enumerate}[label={\alph*)}]
		\item $H_S(w_3(z)) = f_3^z(H_S(r_3(z)),H_S(r_3(x))) = f_3^z(f_0^z(),H_S(w_2(x))) = f_3^z(f_0^z(),f_2^x(H_S(r_2(y)))) = f_3^z(f_0^z(),f_2^x(f_0^y()))$
		\item \input{graph}
			Liest - Von - Relation: 

			$
			RF(S) = \{ (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_3) , (T_0 , z , T_3) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\} 
			$

			Nützlich - Relation: 

			$
			w_0(x) \rightarrow r_1(x) \\
			w_0(y) \rightarrow r_2(y) \\
			w_2(x) \rightarrow r_3(x) \\
			w_0(z) \rightarrow r_3(z) \\
			w_2(x) \rightarrow r_\infty(x) \\
			w_0(y) \rightarrow r_\infty(y) \\
			w_1(z) \rightarrow r_\infty(z) \\
			r_2(y) \rightarrow w_2(x) \\
			r_3(x) \rightarrow w_3(z) \\
			r_3(z) \rightarrow w_3(z) \\
			r_1(x) \rightarrow w_1(z) \\ 
			$

			Lebendige Schritte: 

			$
			w_1(z) , w_2(x) , w_0(y) , r_2(y) , r_1(x) , w_0(x) 
			$

			Lebendige Liest - Von - Relation: 

			$
			LRF(S) = \{ (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\} \\ 
			$
			
		\item $S^{'} := r_3(x) r_3(z) w_3(z) r_1(x) w_1(z) r_2(y) w_2(x)$
			\input{graph_2}
			
			Liest - Von - Relation:

			$
			RF(S') = \{ (T_0 , x , T_3) , (T_0 , z , T_3) , (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\}
			$

			Nützlich - Relation:

			$
			w_0(x) \rightarrow r_3(x) \\
			w_0(z) \rightarrow r_3(z) \\
			w_0(x) \rightarrow r_1(x) \\
			w_0(y) \rightarrow r_2(y) \\
			w_2(x) \rightarrow r_\infty(x) \\
			w_0(y) \rightarrow r_\infty(y) \\
			w_1(z) \rightarrow r_\infty(z) \\
			r_2(y) \rightarrow w_2(x) \\
			r_3(x) \rightarrow w_3(z) \\
			r_3(z) \rightarrow w_3(z) \\
			r_1(x) \rightarrow w_1(z) \\
			$

			Lebendige Schritte:

			$
			w_1(z) , w_2(x) , w_0(y) , r_2(y) , r_1(x) , w_0(x)
			$

			Lebendige Liest - Von - Relation:

			$
			LRF(S') = \{ (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\}
			$
		\item 
			$LRF(S) = \left\{(T_0,y,T_2),(T_0,y,T_\infty),(T_2,x,T_\infty),(T_0,x,T_1),(T_1,z,T_\infty) \right\} =  LRF(S^{'})$\\
			$op(S) = op(S^{'}) \wedge LRF(S) = LRF(S^{'}) \Rightarrow S \approx_{f} S^{'}$ und somit $S \not\in FSR$\\
			$D(S) \neq D(S^{'}) \Rightarrow S \not\approx_{v} S^{'} $
			S $\not\in$ VSR , da es keinen seriellen Schedule gibt mit $$op(S) = op(S')$$ und $$RF(S) = RF(S')$$ Dazu müssen alle möglichen seriellen Schedules getestet werden. 

$$
S_1 = T_3 T_1 T_2
$$

Liest - Von - Relation:

$
RF(S_1) = \{ (T_0 , x , T_3) , (T_0 , z , T_3) , (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\} \\ 
RF(S) \neq RF(S_1)
$

$$
S_2 = T_1 T_2 T_3
$$

Liest - Von - Relation:

$
RF(S_2) = \{ (T_0 , x , T_1) , (T_0 , y , T_2) , (T_2 , x , T_3) , (T_1 , z , T_3) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_3 , z , T_\infty)\} \\
RF(S) \neq RF(S_2)
$

$$
S_3 = T_1 T_3 T_2
$$

Liest - Von - Relation:

$
RF(S_3) = \{ (T_0 , x , T_1) , (T_0 , x , T_3) , (T_1 , z , T_3) , (T_0 , y , T_2) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_3 , z , T_\infty)\} \\
RF(S) \neq RF(S_3)
$

$$
S_4 = T_3 T_2 T_1
$$

Liest - Von - Relation:

$
RF(S_4) = \{ (T_0 , x , T_3) , (T_0 , z , T_3) , (T_0 , y , T_2) , (T_2 , x , T_1) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\} \\
RF(S) \neq RF(S_4)
$

$$
S_5 = T_2 T_1 T_3
$$

Liest - Von - Relation:

$
RF(S_5) = \{ (T_0 , y , T_2) , (T_2 , x , T_1) , (T_1 , x , T_3) , (T_1 , z , T_3) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_3 , z , T_\infty)\} \\ 
RF(S) \neq RF(S_5)
$

$$
S_6 = T_2 T_3 T_1
$$

Liest - Von - Relation:

$
RF(S_6) = \{ (T_0 , y , T_2) , (T_2 , x , T_3) , (T_0 , z , T_3) , (T_2 , x , T_1) , (T_2 , x , T_\infty) , (T_0 , y , T_\infty) , (T_1 , z , T_\infty)\} \\
RF(S) \neq RF(S_6)
$

Somit wurden alle möglichen seriellen Schedules $S_i$ getestet und es ist bewiesen, dass $S \not\in VSR$.
	\end{enumerate}
	
\section{Inconsistent Read in DB2 und PostgreSQL}
	\begin{enumerate}[label={\alph*)}]
		\item \textbf{DB2:} Die Datenbank verhindert das Lesen eines inkonsistenten Systemzustands durch einen Lock auf die jeweilige Tabelle. Eine Select-Query von $T_2$ blockiert bis die Transaktion
			$T_1$ erfolgreich \texttt{Commit;} ausführt oder abgebrochen wird.
		\item \textbf{PostgreSQL:} Dieses \textbf{DBMS} isoliert beide Transaktionen. Die Änderungen von nicht abgeschlossenen Transaktionen können nicht von anderen Transaktionen gelesen werden. Außerdem
			behalten bereits laufende Transaktionen ihre \textbf{Sicht} auf den Systemzustand der zu Beginn der Transaktion bestand.
	\end{enumerate}
\end{document}
